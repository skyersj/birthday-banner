<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>ðŸŽ€ Michelleâ€™s Whimsical Birthday Banner ðŸŽ€</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet"/>
<style>
body {
    font-family: 'Fredoka', sans-serif;
    background-color: #ffe4f0;
    text-align: center;
    padding-top: 30px;
}
/* ---- Cute title styling ---- */
h1 {
    font-size: 2.9em;
    color: #ff69b4;
    text-shadow: 0 2px 10px #fff2fa, 1px 1px #fff, 0 0 18px #ffe4f0;
    background: linear-gradient(90deg, #ff69b4 10%, #ffd700 30%, #fff6a9 50%, #a3ffb1 70%, #6ee7ff 85%, #ff69b4 100%);
    background-size: 300% 100%;
    background-clip: text;
    -webkit-background-clip: text;
    color: transparent;
    -webkit-text-fill-color: transparent;
    animation: cuteShimmer 2.8s linear infinite;
    position: relative;
    z-index: 2;
    letter-spacing: 0.08em;
    transition: transform 0.2s;
    padding: 0.3em 0 0.18em 0;
    margin-bottom: 0.14em;
    font-family: 'Fredoka', cursive, sans-serif;
}
h1::before {
    content: "ðŸŽ€";
    font-size: 0.7em;
    margin-right: 0.14em;
    vertical-align: middle;
    filter: drop-shadow(0 2px 4px #ffd6ec);
    animation: h1BowBounce 2.4s infinite;
}
h1::after {
    content: "ðŸŽ€";
    font-size: 0.7em;
    margin-left: 0.14em;
    vertical-align: middle;
    filter: drop-shadow(0 2px 4px #ffd6ec);
    animation: h1BowBounce 2.4s 1.2s infinite;
}
@keyframes h1BowBounce {
    0%   { transform: scale(1) translateY(0);}
    40%  { transform: scale(1.21) translateY(-4px);}
    60%  { transform: scale(0.92) translateY(2px);}
    100% { transform: scale(1) translateY(0);}
}
@keyframes cuteShimmer {
    0% { background-position: 0% 50%; }
    100% { background-position: 300% 50%; }
}
@media (max-width: 600px) {
    h1 {
        font-size: 2em;
        padding-top: 0.1em;
    }
}
@media (max-width: 410px) {
    h1 {
        font-size: 1.18em;
        padding-top: 0;
    }
}
/* ---- End cute title styling ---- */
#rainbowOverlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 200vw;
    height: 200vh;
    background: linear-gradient(45deg, #ffe4f0, #e0f7ff, #fff4d6, #e0ffe6, #ffe4f0);
    background-size: 400% 400%;
    opacity: 0.4;
    z-index: 0;
    pointer-events: none;
    animation: rainbowShift 20s linear infinite;
}
@keyframes rainbowShift {
    0% { background-position: 0% 50%; }
    100% { background-position: 100% 50%; }
}
#sparkleBg {
    position: fixed;
    top: 0; left: 0; width: 100vw; height: 100vh;
    z-index: 1;
    pointer-events: none;
    overflow: hidden;
}
.sparkle {
    position: absolute;
    width: 18px;
    height: 18px;
    opacity: 0.85;
    pointer-events: none;
    z-index: 1;
    will-change: transform, opacity;
    animation: sparkleMove 3s linear forwards;
}
.sparkle svg {
    width: 100%;
    height: 100%;
    display: block;
}
@keyframes sparkleMove {
    0% { opacity: 0; transform: scale(0.3) translateY(0px) rotate(0deg);}
    10% { opacity: 1; transform: scale(1.1) translateY(-10px) rotate(12deg);}
    80% { opacity: 1; }
    100% { opacity: 0; transform: scale(0.8) translateY(-60px) rotate(40deg);}
}
.heart {
    position: absolute;
    width: 20px;
    height: 20px;
    opacity: 0.75;
    pointer-events: none;
    z-index: 1;
    will-change: transform, opacity;
    animation: heartMove 3.5s linear forwards;
}
.heart svg {
    width: 100%;
    height: 100%;
    display: block;
}
@keyframes heartMove {
    0% { opacity: 0; transform: scale(0.4) translateY(0px) rotate(-10deg);}
    15% { opacity: 1; transform: scale(1.2) translateY(-18px) rotate(10deg);}
    80% { opacity: 1; }
    100% { opacity: 0; transform: scale(0.7) translateY(-70px) rotate(40deg);}
}
.star {
    position: absolute;
    width: 18px;
    height: 18px;
    opacity: 0.8;
    pointer-events: none;
    z-index: 1;
    will-change: transform, opacity;
    animation: starMove 4s linear forwards;
}
.star svg { width: 100%; height: 100%; display: block; }
@keyframes starMove {
    0% { opacity: 0; transform: scale(0.3) translateY(0px) rotate(-12deg);}
    15% { opacity: 1; transform: scale(1.1) translateY(-12px) rotate(17deg);}
    80% { opacity: 1; }
    100% { opacity: 0; transform: scale(0.7) translateY(-80px) rotate(43deg);}
}
.flower {
    position: absolute;
    width: 19px;
    height: 19px;
    opacity: 0.77;
    pointer-events: none;
    z-index: 1;
    will-change: transform, opacity;
    animation: flowerMove 3.8s linear forwards;
}
.flower svg { width: 100%; height: 100%; display: block; }
@keyframes flowerMove {
    0% { opacity: 0; transform: scale(0.5) translateY(0px) rotate(-6deg);}
    13% { opacity: 1; transform: scale(1.07) translateY(-10px) rotate(8deg);}
    80% { opacity: 1; }
    100% { opacity: 0; transform: scale(0.6) translateY(-70px) rotate(38deg);}
}
#pullCounterBox {
    position: fixed;
    top: 28px;
    right: 28px;
    background: rgba(255,255,255,0.93);
    border-radius: 22px;
    box-shadow: 0 4px 20px 3px #ffd6ec;
    padding: 18px 28px 14px 22px;
    border: 3px solid #ffe6fa;
    z-index: 20;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 100px;
    animation: tableIn 1.1s cubic-bezier(.53,1.72,.22,.86) 0.2s both;
}
#pullCounterBox span {
    font-size: 1.12em;
    font-weight: 600;
    color: #a052a0;
    letter-spacing: 0.03em;
    margin-bottom: 7px;
}
#pullCounterBox .counter-value {
    font-family: 'Fredoka', sans-serif;
    font-size: 2.3em;
    color: #4bb7e3;
    text-shadow: 0 1px 0 #fff7fb, 0 0 8px #aeefff;
    font-weight: 600;
    letter-spacing: 0.03em;
}
#pullCounterBox.counter-animate .counter-value {
    animation: counterPop 0.5s cubic-bezier(.68,-0.55,.27,1.55);
}
#pullCounterBox .coin-icon {
    display: inline-block;
    vertical-align: middle;
    width: 1.3em;
    height: 1.3em;
    margin-right: 0.18em;
    margin-bottom: 0.08em;
}
@keyframes counterPop {
    0% { transform: scale(1.4); color: #ffd700;}
    60% { transform: scale(0.85); color: #4bb7e3;}
    100% { transform: scale(1);}
}
@media (max-width: 700px) {
    #pullCounterBox {
        right: 2vw;
        min-width: 70px;
        padding: 10px 12px 10px 10px;
    }
}
.main-flex-row {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: flex-start;
    gap: 32px;
    margin-top: 24px;
    margin-bottom: 16px;
    width: 100%;
    max-width: 100vw;
    box-sizing: border-box;
}
#result {
    display: none;
    position: fixed;
    left: 28px;
    bottom: 28px;
    background: linear-gradient(120deg, #fff7fb 85%, #e0f7ff 100%);
    border-radius: 18px;
    border: 2px solid #ffe6fa;
    box-shadow: 0 0 12px #ffe6fa90, 0 2px 6px #ffd6ec66;
    padding: 14px 18px;
    font-size: 1.15em;
    font-weight: bold;
    color: #c058a0;
    min-width: 170px;
    min-height: 36px;
    z-index: 10002;
    animation: rewardPop 0.7s cubic-bezier(.6,1.7,.5,.9);
    flex-direction: column;
    align-items: flex-start;
    text-align: left;
}
@media (max-width: 800px) {
    #result {
        left: 4vw;
        bottom: 18vw;
        min-width: 0;
        max-width: 90vw;
        font-size: 0.97em;
        padding: 10px 7px;
    }
}
@media (max-width: 480px) {
    #result {
        left: 2vw;
        bottom: 24vw;
        min-width: 0;
        max-width: 95vw;
        font-size: 0.89em;
        padding: 6px 4px;
    }
}
.new-badge {
    display: inline-block;
    background: #ffe94d;
    color: #ba7b00;
    font-size: 0.85em;
    font-weight: bold;
    padding: 2px 10px;
    border-radius: 16px;
    margin-right: 10px;
    letter-spacing: 0.08em;
    margin-bottom: 4px;
    border: 2px solid #fff9bb;
    box-shadow: 0 2px 8px #fff9bb99;
    vertical-align: middle;
    animation: newPulse 1.2s infinite alternate;
}
@keyframes newPulse {
    0% { background: #ffe94d; color: #ba7b00;}
    100% { background: #fffbcf; color: #bfa000;}
}
#percentages {
    margin-top: 20px;
    font-size: 1.07em;
    width: 360px;
    max-width: 96vw;
    margin-left: auto; margin-right: auto;
    background: rgba(255,255,255,0.92);
    border-radius: 22px;
    box-shadow: 0 4px 20px 3px #ffd6ec;
    padding: 24px 22px 16px 22px;
    border: 3px solid #ffe6fa;
    position: relative;
    z-index: 3;
    overflow: hidden;
    transition: box-shadow 0.3s;
}
#percentages::before {
    content: '';
    position: absolute;
    left: -20%;
    top: -30%;
    width: 150%;
    height: 170%;
    z-index: 0;
    opacity: 0.22;
    background: repeating-linear-gradient(120deg, #fff4d6 0%, #ffe4f0 30%, #e0f7ff 60%, #e0ffe6 100%);
    background-size: 300% 300%;
    animation: lootBgAnim 8s linear infinite;
    border-radius: 20px;
    filter: blur(12px);
    pointer-events: none;
}
@keyframes lootBgAnim {
    0% { background-position: 0% 50%; }
    100% { background-position: 100% 50%; }
}
.percentage-entry {
    margin: 8px 0;
    border-radius: 15px;
    display: flex;
    align-items: center;
    font-size: 1.08em;
    padding: 7px 14px 7px 8px;
    border: 2px dashed #ffe4f0;
    background: #fff7fb;
    box-shadow: 0 1px 8px #ffe6fa60;
    animation: lootRowPop 0.7s cubic-bezier(.6,1.7,.5,.9);
    transition: background 0.2s, border 0.2s, box-shadow 0.2s;
}
@keyframes lootRowPop {
    0% { opacity: 0; transform: scale(0.7);}
    70% { opacity: 1; transform: scale(1.1);}
    100% { opacity: 1; transform: scale(1);}
}
.percentage-entry.common {
    background: #e7f7ff;
    border-color: #b3e8ff;
}
.percentage-entry.rare {
    background: #f7e7ff;
    border-color: #e0b3ff;
}
.percentage-entry.ultra-rare {
    background: #fffbe7;
    border-color: #ffe7b3;
}
#result .reward-icon {
    position: absolute;
    left: -32px;
    top: 50%;
    transform: translateY(-50%);
    width: 40px; height: 40px;
    filter: drop-shadow(0 0 12px #fff6a9);
}
#result.common { color: #4bb7e3;}
#result.rare { color: #a096f7;}
#result.ultra-rare { color: #e2b74c;}
.table-in {
    opacity: 0;
    transform: translateY(30px) scale(0.97);
    animation: tableIn 1.1s cubic-bezier(.53,1.72,.22,.86) 0.2s forwards;
}
@keyframes tableIn {
    0% { opacity: 0; transform: translateY(30px) scale(0.97);}
    80% { opacity: 1; transform: translateY(-7px) scale(1.04);}
    100% { opacity: 1; transform: translateY(0) scale(1);}
}
#percentages.loot-pulse {
    animation: lootPulse 0.88s cubic-bezier(.16,1.41,.78,1.13);
}
@keyframes lootPulse {
    0% { box-shadow: 0 2px 14px 2px #ffc1e0, 0 0 0 0 #ffe4f0; }
    40% { box-shadow: 0 0 36px 12px #ffe4f0, 0 2px 14px 2px #ffc1e0; }
    70% { box-shadow: 0 2px 14px 2px #ffc1e0, 0 0 0 0 #ffe4f0;}
    100% { box-shadow: 0 2px 14px 2px #ffc1e0; }
}
.percentage-entry.removing {
    opacity: 0;
    transform: translateX(60px) scale(0.7) rotateZ(-18deg);
    transition: opacity 0.6s, transform 0.6s cubic-bezier(.68,-0.55,.27,1.55);
}
#result .bounce { animation: bounce 0.6s ease-out; }
@keyframes bounce {
    0% { transform: scale(0.7); opacity: 0.5; }
    60% { transform: scale(1.2); opacity: 1; }
    100% { transform: scale(1); }
}
.history-entry {
    background-color: rgba(255, 255, 255, 0.7);
    border-radius: 15px;
    padding: 10px 15px;
    margin: 10px auto;
    width: fit-content;
    animation: slideIn 0.5s ease-out;
    display: block;
}
@keyframes slideIn {
    from { transform: translateY(20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}
.common { background-color: #e3f2ff; border: 2px dashed #3399ff; color: #3399ff; }
.rare { background-color: #f3e3ff; border: 2px dashed #a020f0; color: #a020f0; }
.ultra-rare { background-color: #fff9d6; border: 2px dashed #ffd700; color: #ffd700; }
button {
    background-color: #fff0f5;
    color: #a052a0;
    border: 2px solid #ffb6c1;
    border-radius: 30px;
    font-weight: bold;
    padding: 12px 25px;
    box-shadow: 2px 2px 6px rgba(0,0,0,0.1);
    transition: 
        background 0.3s, 
        color 0.3s, 
        transform 0.2s cubic-bezier(.68,-0.55,.27,1.55), 
        box-shadow 0.3s,
        filter 0.3s;
    font-family: 'Fredoka', sans-serif;
    margin: 10px;
    font-size: 1.2em;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    z-index: 10;
    animation: buttonFloat 3.5s ease-in-out infinite;
}
@keyframes buttonFloat {
    0%   { transform: translateY(0) scale(1);}
    40%  { transform: translateY(-3px) scale(1.012);}
    50%  { transform: translateY(-6px) scale(1.02);}
    60%  { transform: translateY(-3px) scale(1.012);}
    100% { transform: translateY(0) scale(1);}
}
button:hover {
    background: linear-gradient(90deg, #fff0f5 60%, #ffe4f0 100%);
    color: #d63384;
    transform: scale(1.07) rotate(-2deg);
    box-shadow: 0 0 20px 0 #ffc2e4, 0 2px 14px 2px #ffc1e0;
    filter: brightness(1.08);
    animation: buttonJelly 0.6s cubic-bezier(.68,-0.55,.27,1.55);
}
@keyframes buttonJelly {
    0% { transform: scale(1) rotate(0deg);}
    25% { transform: scale(1.12, 0.93) rotate(-1deg);}
    50% { transform: scale(0.95, 1.08) rotate(-3deg);}
    75% { transform: scale(1.03, 0.98) rotate(-2deg);}
    100% { transform: scale(1.07) rotate(-2deg);}
}
button:active {
    filter: brightness(0.95);
    transition: filter 0.1s;
    animation: buttonPop 0.25s;
}
@keyframes buttonPop {
    0% { transform: scale(1.07) rotate(-2deg);}
    60% { transform: scale(0.93) rotate(2deg);}
    100% { transform: scale(1.03) rotate(0deg);}
}
button .btn-sparkle {
    pointer-events: none;
    position: absolute;
    width: 16px;
    height: 16px;
    z-index: 999;
    opacity: 0;
    animation: btnSparkleAnim 0.9s forwards;
}
@keyframes btnSparkleAnim {
    0% {
        opacity: 0.9;
        transform: scale(0.2) rotate(0deg);
    }
    40% {
        opacity: 1;
        transform: scale(1.3) rotate(20deg);
    }
    70% {
        opacity: 0.7;
        transform: scale(0.7) rotate(44deg);
    }
    100% {
        opacity: 0;
        transform: scale(0.2) rotate(60deg);
    }
}
#history {
    display: block;
    margin-top: 30px;
    transition: max-height 0.5s cubic-bezier(.4,2,.6,1), opacity 0.5s;
    max-height: 1000px;
    opacity: 1;
    overflow: hidden;
}
#history.hide {
    max-height: 0;
    opacity: 0;
    transition: max-height 0.5s cubic-bezier(.4,2,.6,1), opacity 0.5s;
    display: block;
}
#ultraBanner {
    position: fixed;
    top: 30%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.8);
    background: #fff7c2;
    border: 3px solid gold;
    padding: 20px 40px;
    border-radius: 20px;
    font-size: 2em;
    font-weight: bold;
    color: #d4af37;
    box-shadow: 0 0 30px gold;
    z-index: 9999;
    opacity: 0;
    display: none;
    animation: bannerPop 1s ease-out forwards;
}
#birthdayBanner {
    position: fixed;
    top: 15%;
    left: 50%;
    transform: translate(-50%, -50%) scale(1.1);
    background: linear-gradient(90deg, #fff6a9, #fcd2ff, #c6f2ff, #ffe4f0);
    border: 4px solid #ff69b4;
    padding: 28px 55px;
    border-radius: 32px;
    font-size: 2.3em;
    font-weight: bold;
    color: #d63384;
    box-shadow: 0 0 38px 6px #ffb6c1, 0 0 60px 24px #fff4d6;
    z-index: 10000;
    opacity: 0;
    display: none;
    animation: birthdayPop 1.6s cubic-bezier(.4,2,.6,1) forwards;
    letter-spacing: 0.07em;
    text-shadow: 2px 2px 0 #fff, 0 0 10px #ffe4f0, 0 0 24px #ff8fc2;
}
@keyframes birthdayPop {
    0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5);}
    50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2);}
    100% { opacity: 1; transform: translate(-50%, -50%) scale(1.1);}
}
@keyframes bannerPop {
    0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
    50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
    100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
}
.confetti {
    position: fixed;
    width: 10px;
    height: 10px;
    background-color: #ffccff;
    opacity: 0.9;
    z-index: 9998;
    animation: confettiFall 2s linear forwards;
}
@keyframes confettiFall {
    0% { transform: translateY(-50px) rotate(0deg); }
    100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
}
#rainbowBurst {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: radial-gradient(circle, #fff6a9, #fcd2ff, #c6f2ff, transparent);
    z-index: 9997;
    opacity: 0;
    pointer-events: none;
}
@keyframes rainbowBurstAnim {
    0% { opacity: 0; }
    50% { opacity: 0.9; }
    100% { opacity: 0; }
}
body.rainbow-common::before,
body.rainbow-rare::before,
body.rainbow-ultra::before {
    content: '';
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    background: linear-gradient(45deg, #ffe4f0, #e0f7ff, #fff4d6, #e0ffe6, #ffe4f0);
    background-size: 400% 400%;
    opacity: 0.4;
    pointer-events: none;
    z-index: 1;
}
body.rainbow-common::before { animation: rainbowShift 1.2s ease-out, pulseGlowCommon 1s ease-out; }
body.rainbow-rare::before { animation: rainbowShift 1.2s ease-out, pulseGlowRare 1.2s ease-out; }
body.rainbow-ultra::before { animation: rainbowShift 1.5s ease-out, pulseGlowUltra 1.5s ease-out; }
@keyframes pulseGlowCommon {
    0% { opacity: 0.4; }
    50% { opacity: 0.6; }
    100% { opacity: 0.4; }
}
@keyframes pulseGlowRare {
    0% { opacity: 0.5; }
    50% { opacity: 0.8; }
    100% { opacity: 0.4; }
}
@keyframes pulseGlowUltra {
    0% { opacity: 0.6; }
    50% { opacity: 1; }
    100% { opacity: 0.4; }
}
#bottomCountdown {
    position: fixed;
    right: 28px;
    bottom: 24px;
    z-index: 10001;
    background: rgba(255,255,255,0.98);
    border-radius: 18px;
    box-shadow: 0 4px 16px 2px #ffd6ec;
    border: 2.5px solid #ffe6fa;
    padding: 14px 24px 12px 20px;
    display: flex;
    align-items: center;
    font-family: 'Fredoka', sans-serif;
    font-size: 1.18em;
    color: #a052a0;
    min-width: 170px;
    gap: 10px;
    animation: tableIn 1s cubic-bezier(.53,1.72,.22,.86) 0.2s both;
    transition: background 0.3s, box-shadow 0.3s;
}
#bottomCountdown .days-number {
    font-size: 2em;
    color: #e76a84;
    font-weight: 600;
    padding-left: 8px;
    letter-spacing: 0.03em;
    text-shadow: 0 1px 0 #fff7fb, 0 0 8px #ffc4d6;
}
#bottomCountdown .clock-icon {
    width: 1.5em; height: 1.5em;
    margin-right: 8px;
    vertical-align: middle;
    display: inline-block;
}
@media (max-width: 700px) {
    #pullCounterBox {
        right: 2vw;
        min-width: 70px;
        padding: 10px 12px 10px 10px;
    }
    #bottomCountdown {
        right: 5vw;
        bottom: 12px;
        padding: 10px 10px 10px 10px;
        font-size: 1em;
    }
    #bottomCountdown .days-number { font-size: 1.3em; }
}
::selection { background: #ffd9ec; }
</style>
<body>
<div id="rainbowOverlay"></div>
<div id="sparkleBg"></div>
<div id="pullCounterBox">
    <span>
      <svg class="coin-icon" viewBox="0 0 22 22" fill="none">
        <circle cx="11" cy="11" r="9" fill="#FFD700" stroke="#F7C948" stroke-width="2"/>
        <circle cx="11" cy="11" r="5" fill="#FFF9C4" stroke="#F7C948" stroke-width="1.2"/>
        <ellipse cx="11" cy="7.5" rx="1.2" ry="1.5" fill="#FFFCE1" opacity="0.77"/>
      </svg>
      Percoins Left
    </span>
    <span class="counter-value" id="pullCounterValue">10</span>
</div>
<h1>Michelleâ€™s Whimsical Birthday Banner</h1>
<div class="main-flex-row">
    <div id="percentages"></div>
</div>
<button id="pullBtn" onclick="pullGacha()">PULL!</button>
<button onclick="clearHistory()">Reset</button>
<button id="toggleHistoryBtn" onclick="toggleHistory()">Show History</button>
<div id="result"></div>
<div id="history" class="hide"></div>
<div id="rainbowBurst"></div>
<div id="ultraBanner">âœ¨ ULTRA RARE! âœ¨</div>
<div id="birthdayBanner">ðŸŽ‚ Happy Birthday, Michelle! ðŸŽ‰</div>
<div id="bottomCountdown">
    <span class="clock-icon">
        <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
            <circle cx="16" cy="16" r="14" stroke="#a052a0" stroke-width="2.3" fill="#fff6fa"/>
            <circle cx="16" cy="16" r="11.5" stroke="#e6a8d7" stroke-width="1" fill="#fff"/>
            <path d="M16 10v6l4 4" stroke="#e76a84" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </span>
    Days remaining:
    <span class="days-number" id="countdownDaysValue">--</span>
</div>
<audio id="pullSound" preload="auto" src="pull-sound.mp3"></audio>
<audio autoplay="" id="bgMusic" loop="" src="whims-theme.mp3"></audio>
<button id="musicBtn" onclick="toggleMusic()" style="position: fixed; top: 20px; left: 20px; z-index: 2000;">ðŸŽµ Toggle Music</button>
<audio id="commonSound" preload="auto" src="pull-common.mp3"></audio>
<audio id="rareSound" preload="auto" src="pull-rare.mp3"></audio>
<audio id="ultraRareSound" preload="auto" src="pull-ultra.mp3"></audio>
<audio id="birthdaySound" preload="auto" src="https://cdn.pixabay.com/audio/2022/03/15/audio_115b9c9b3e.mp3"></audio>
<script>
function randomColor() {
    const pastel = [
        "#fff8f0", "#ffe9fa", "#e0f7ff", "#fff4d6", "#e0ffe6",
        "#ffb6c1", "#fcd2ff", "#c6f2ff", "#ffe4f0", "#fff6a9"
    ];
    return pastel[Math.floor(Math.random() * pastel.length)];
}
function randomSparkleSvg(fill) {
    return `<svg viewBox="0 0 18 18" fill="none"><polygon points="9,1 11,7 17,9 11,11 9,17 7,11 1,9 7,7" fill="${fill}" opacity="0.88"/></svg>`;
}
function spawnSparkle() {
    const sparkleBg = document.getElementById('sparkleBg');
    if (!sparkleBg) return;
    const sparkle = document.createElement('div');
    sparkle.className = 'sparkle';
    sparkle.style.left = (Math.random() * 100) + "vw";
    sparkle.style.top = (Math.random() * 98) + "vh";
    const scale = 0.6 + Math.random() * 0.7;
    sparkle.style.transform = `scale(${scale})`;
    sparkle.style.animationDelay = (Math.random() * 1.5) + "s";
    sparkle.innerHTML = randomSparkleSvg(randomColor());
    sparkleBg.appendChild(sparkle);
    setTimeout(() => {
        if (sparkle.parentNode) sparkle.parentNode.removeChild(sparkle);
    }, 3000);
}
function randomHeartColor() {
    const colors = ["#ffb6c1", "#ff69b4", "#ffc1e0", "#ffdee8", "#ffd6ec"];
    return colors[Math.floor(Math.random() * colors.length)];
}
function randomHeartSvg(fill) {
    return `<svg viewBox="0 0 20 18"><path d="M10 16s-5.3-4.2-8-7C-2.2 3.6 3.6-1.4 10 5.6 16.4-1.4 22.2 3.6 18 9c-2.7 2.8-8 7-8 7z" fill="${fill}"/></svg>`;
}
function spawnHeart() {
    const sparkleBg = document.getElementById('sparkleBg');
    if (!sparkleBg) return;
    const heart = document.createElement('div');
    heart.className = 'heart';
    heart.style.left = (Math.random() * 100) + "vw";
    heart.style.top = (Math.random() * 98) + "vh";
    const scale = 0.6 + Math.random() * 0.7;
    heart.style.transform = `scale(${scale})`;
    heart.style.animationDelay = (Math.random() * 1.5) + "s";
    heart.innerHTML = randomHeartSvg(randomHeartColor());
    sparkleBg.appendChild(heart);
    setTimeout(() => {
        if (heart.parentNode) heart.parentNode.removeChild(heart);
    }, 3500);
}
function randomStarColor() {
    const colors = ["#fffbe7", "#ffe6fa", "#b3f8ff", "#ffe4a0", "#fff6d6"];
    return colors[Math.floor(Math.random() * colors.length)];
}
function randomStarSvg(fill) {
    return `<svg viewBox="0 0 18 18"><polygon points="9,1 11,7 17,7 12,11 14,17 9,13 4,17 6,11 1,7 7,7" fill="${fill}" opacity="0.95"/></svg>`;
}
function spawnStar() {
    const sparkleBg = document.getElementById('sparkleBg');
    if (!sparkleBg) return;
    const star = document.createElement('div');
    star.className = 'star';
    star.style.left = (Math.random() * 100) + "vw";
    star.style.top = (Math.random() * 98) + "vh";
    const scale = 0.7 + Math.random() * 0.7;
    star.style.transform = `scale(${scale})`;
    star.style.animationDelay = (Math.random() * 1.5) + "s";
    star.innerHTML = randomStarSvg(randomStarColor());
    sparkleBg.appendChild(star);
    setTimeout(() => {
        if (star.parentNode) star.parentNode.removeChild(star);
    }, 4000);
}
function randomFlowerColor() {
    const colors = ["#ffd6f3", "#eaffd6", "#fff6a9", "#ffe6e6", "#d6eaff"];
    return colors[Math.floor(Math.random() * colors.length)];
}
function randomFlowerSvg(fill) {
    return `<svg viewBox="0 0 20 20">
        <circle cx="10" cy="10" r="4" fill="${fill}" opacity="0.95"/>
        <ellipse cx="10" cy="3.5" rx="2.2" ry="4" fill="${fill}" opacity="0.8"/>
        <ellipse cx="16.5" cy="10" rx="4" ry="2.2" fill="${fill}" opacity="0.8" transform="rotate(72 10 10)"/>
        <ellipse cx="13.5" cy="16.5" rx="2.2" ry="4" fill="${fill}" opacity="0.8" transform="rotate(144 10 10)"/>
        <ellipse cx="6.5" cy="16.5" rx="2.2" ry="4" fill="${fill}" opacity="0.8" transform="rotate(216 10 10)"/>
        <ellipse cx="3.5" cy="10" rx="4" ry="2.2" fill="${fill}" opacity="0.8" transform="rotate(288 10 10)"/>
    </svg>`;
}
function spawnFlower() {
    const sparkleBg = document.getElementById('sparkleBg');
    if (!sparkleBg) return;
    const flower = document.createElement('div');
    flower.className = 'flower';
    flower.style.left = (Math.random() * 100) + "vw";
    flower.style.top = (Math.random() * 98) + "vh";
    const scale = 0.7 + Math.random() * 0.7;
    flower.style.transform = `scale(${scale})`;
    flower.style.animationDelay = (Math.random() * 1.5) + "s";
    flower.innerHTML = randomFlowerSvg(randomFlowerColor());
    sparkleBg.appendChild(flower);
    setTimeout(() => {
        if (flower.parentNode) flower.parentNode.removeChild(flower);
    }, 3800);
}
setInterval(() => {
    for (let i = 0; i < 4; i++) {
        if (Math.random() < 0.96) spawnSparkle();
    }
}, 70);
setInterval(() => {
    if (Math.random() < 0.5) spawnHeart();
}, 110);
setInterval(() => {
    if (Math.random() < 0.5) spawnStar();
}, 125);
setInterval(() => {
    if (Math.random() < 0.5) spawnFlower();
}, 160);

let pullCounter = 10;
function updatePullCounter(animated=true) {
    const counter = document.getElementById('pullCounterValue');
    const box = document.getElementById('pullCounterBox');
    counter.textContent = pullCounter;
    if (animated) {
        box.classList.remove('counter-animate');
        void box.offsetWidth;
        box.classList.add('counter-animate');
        setTimeout(() => box.classList.remove('counter-animate'), 500);
    }
}
function buttonSparkleBurst(btn) {
    for (let i = 0; i < 4; i++) {
        const s = document.createElement('span');
        s.className = 'btn-sparkle';
        s.style.left = (btn.offsetWidth/2 - 8) + 'px';
        s.style.top = (btn.offsetHeight/2 - 8) + 'px';
        s.innerHTML = randomSparkleSvg(randomColor());
        const angle = Math.random()*2*Math.PI;
        const dist = 20 + Math.random()*16;
        s.style.transform = `translate(0,0)`;
        btn.appendChild(s);
        setTimeout(() => {
            s.style.transform = `translate(${Math.cos(angle)*dist}px,${Math.sin(angle)*dist}px) scale(1.1)`;
        }, 10);
        setTimeout(() => {
            if (s.parentNode) s.parentNode.removeChild(s);
        }, 800);
    }
}
function addButtonSparkleEvents() {
    const btns = document.querySelectorAll('button');
    btns.forEach(btn => {
        if (!btn._sparkleAttached) {
            btn.addEventListener('click', function(e) {
                buttonSparkleBurst(btn);
            });
            btn._sparkleAttached = true;
        }
    });
}
addButtonSparkleEvents();
const observer = new MutationObserver(addButtonSparkleEvents);
observer.observe(document.body, { childList: true, subtree: true });
function pulseLootTable() {
    const lootTable = document.getElementById('percentages');
    lootTable.classList.remove('loot-pulse');
    void lootTable.offsetWidth;
    lootTable.classList.add('loot-pulse');
    setTimeout(() => lootTable.classList.remove('loot-pulse'), 900);
}
window.addEventListener('DOMContentLoaded', () => {
    const lootTable = document.getElementById('percentages');
    lootTable.classList.add('table-in');
    lootTable.addEventListener('animationend', function handler(e) {
        if (e.animationName === 'tableIn') {
            lootTable.classList.remove('table-in');
            lootTable.removeEventListener('animationend', handler);
        }
    });
    updatePullCounter(false);
});
function animateLootRemoval(itemName, callback) {
    const entries = document.querySelectorAll('.percentage-entry');
    for (let entry of entries) {
        const nameMatch = entry.textContent.match(/^(.+?) \(/);
        if (nameMatch && nameMatch[1] === itemName) {
            entry.classList.add('removing');
            setTimeout(() => {
                if (entry.parentNode) entry.parentNode.removeChild(entry);
                if (callback) callback();
            }, 600);
            return;
        }
    }
    if (callback) callback();
}
const originalItems = [
    { name: "Pompompurin Cardigan", rarity: "common", stars: "â­ï¸â­ï¸â­ï¸", chance: 17.08 },
    { name: "Moon Frame", rarity: "common", stars: "â­ï¸â­ï¸â­ï¸", chance: 17.08 },
    { name: "Bear Bracelet", rarity: "common", stars: "â­ï¸â­ï¸â­ï¸", chance: 17.08 },
    { name: "Whimsicott Plushie", rarity: "common", stars: "â­ï¸â­ï¸â­ï¸", chance: 17.08 },
    { name: "Pompompurin Bag Cup", rarity: "common", stars: "â­ï¸â­ï¸â­ï¸", chance: 17.08 },
    { name: "Build-a-Bear Purin", rarity: "rare", stars: "â­ï¸â­ï¸â­ï¸â­ï¸", chance: 4.33 },
    { name: "Persimmon Necklace", rarity: "rare", stars: "â­ï¸â­ï¸â­ï¸â­ï¸", chance: 4.33 },
    { name: "Tamagotchi Bag", rarity: "rare", stars: "â­ï¸â­ï¸â­ï¸â­ï¸", chance: 4.33 },
    { name: "Stitch Hoodie", rarity: "ultra-rare", stars: "â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸", chance: 0.8 },
    { name: "Shell Set", rarity: "ultra-rare", stars: "â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸", chance: 0.8 }
];
let pool = [...originalItems];
let historyVisible = false;
function updatePercentagesDisplay() {
    const container = document.getElementById('percentages');
    container.innerHTML = '';
    const totalWeight = pool.reduce((sum, item) => sum + item.chance, 0);
    const historyItems = Array.from(document.querySelectorAll('.history-entry')).map(entry => {
        const match = entry.textContent.match(/ðŸŽ (.+) \((â­ï¸+)\)/);
        return match ? match[1] : null;
    }).filter(Boolean);
    pool.forEach(item => {
        const percentage = ((item.chance / totalWeight) * 100).toFixed(2);
        const div = document.createElement('div');
        div.className = `percentage-entry ${item.rarity}`;
        const displayName = historyItems.includes(item.name) ? item.name : "????";
        div.innerHTML = `<span>${displayName} (${item.stars})</span>: <b>${percentage}%</b>`;
        container.appendChild(div);
    });
}
function playRaritySound(rarity) {
    const sounds = {
        'common': document.getElementById('commonSound'),
        'rare': document.getElementById('rareSound'),
        'ultra-rare': document.getElementById('ultraRareSound')
    };
    if (sounds[rarity]) sounds[rarity].play();
}
function showUltraBanner() {
    const banner = document.getElementById('ultraBanner');
    banner.style.display = 'block';
    banner.style.opacity = '1';
    banner.style.animation = 'bannerPop 1s ease-out forwards';
    setTimeout(() => {
        banner.style.opacity = '0';
        banner.style.display = 'none';
    }, 2000);
}
function showBirthdayBanner() {
    const banner = document.getElementById('birthdayBanner');
    const sound = document.getElementById('birthdaySound');
    banner.style.display = 'block';
    banner.style.opacity = '1';
    banner.style.animation = 'birthdayPop 1.6s cubic-bezier(.4,2,.6,1) forwards';
    if (sound) sound.play();
    setTimeout(() => {
        banner.style.opacity = '0';
        banner.style.display = 'none';
    }, 4300);
}
function showConfetti() {
    for (let i = 0; i < 20; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * window.innerWidth + 'px';
        confetti.style.backgroundColor = `hsl(${Math.random()*360},100%,85%)`;
        confetti.style.animationDuration = (1.5 + Math.random()) + 's';
        document.body.appendChild(confetti);
        setTimeout(() => confetti.remove(), 2000);
    }
}
function showRainbowBurst() {
    const burst = document.getElementById('rainbowBurst');
    burst.style.animation = 'none';
    void burst.offsetWidth;
    burst.style.animation = 'rainbowBurstAnim 1.5s ease-out forwards';
    setTimeout(() => burst.style.animation = '', 1600);
}
function pulseRainbowByRarity(rarity) {
    document.body.classList.remove('rainbow-common', 'rainbow-rare', 'rainbow-ultra');
    const classMap = {
        'common': 'rainbow-common',
        'rare': 'rainbow-rare',
        'ultra-rare': 'rainbow-ultra'
    };
    const className = classMap[rarity];
    if (className) {
        document.body.classList.add(className);
        setTimeout(() => document.body.classList.remove(className), 1500);
    }
}
function revealRewardSlowly(container, text, className, callback, selected) {
    container.innerHTML = "";
    let i = 0;
    const rewardDiv = document.createElement("div");
    rewardDiv.className = className;
    rewardDiv.style.position = "relative";
    rewardDiv.innerHTML = `<span class="reward-icon"></span>`;
    const mainText = `<span style="font-size:1.2em;">You got:</span><br>
    <span class="new-badge">NEW!</span><span style="font-size:1.25em;">${selected.name} (${selected.stars})</span>
    <span style="font-size:1.5em;">âœ¨</span>`;
    const revealSpan = document.createElement("span");
    rewardDiv.appendChild(revealSpan);
    container.appendChild(rewardDiv);
    function typeNext() {
        revealSpan.innerHTML = mainText.slice(0, i);
        i++;
        if (i <= mainText.length) {
            setTimeout(typeNext, 18);
        } else if (callback) {
            callback();
        }
    }
    typeNext();
}
function pullGacha() {
    if (pool.length === 0) {
        alert("ðŸŽŠ All items have been pulled! The pool will now reset.");
        pool = [...originalItems];
        updatePercentagesDisplay();
        pulseLootTable();
        pullCounter = 10;
        updatePullCounter();
        return;
    }
    if (pullCounter > 0) {
        pullCounter--;
        updatePullCounter();
    }
    const totalWeight = pool.reduce((sum, item) => sum + item.chance, 0);
    let rand = Math.random() * totalWeight;
    let selected;
    for (let item of pool) {
        if (rand < item.chance) {
            selected = item;
            break;
        }
        rand -= item.chance;
    }
    animateLootRemoval(selected.name, () => {
        pool = pool.filter(i => i.name !== selected.name);
        const resultDiv = document.getElementById('result');
        // Show the result box if it's hidden
        if (resultDiv.style.display === "" || resultDiv.style.display === "none") {
            if (window.innerWidth <= 800) {
                resultDiv.style.display = "block";
            } else {
                resultDiv.style.display = "flex";
            }
        }
        revealRewardSlowly(resultDiv, '', selected.rarity, function() {
            const history = document.getElementById('history');
            const newEntry = document.createElement('div');
            newEntry.className = `history-entry ${selected.rarity}`;
            newEntry.textContent = `ðŸŽ ${selected.name} (${selected.stars})`;
            history.insertBefore(newEntry, history.firstChild);
            updatePercentagesDisplay();
            if (pool.length === 0) {
                showBirthdayBanner();
                showConfetti();
            }
        }, selected);
        playRaritySound(selected.rarity);
        updatePercentagesDisplay();
        pulseRainbowByRarity(selected.rarity);
        pulseLootTable();
        if (selected.rarity === 'ultra-rare') {
            showUltraBanner();
            showRainbowBurst();
            showConfetti();
        }
    });
}
function clearHistory() {
    pool = [...originalItems];
    updatePercentagesDisplay();
    document.getElementById('history').innerHTML = '';
    document.getElementById('result').innerHTML = '';
    pullCounter = 10;
    updatePullCounter();
    pulseLootTable();
    document.getElementById('result').style.display = "none"; // Hide reward box again on reset
}
function toggleHistory() {
    const historyDiv = document.getElementById('history');
    const btn = document.getElementById('toggleHistoryBtn');
    historyVisible = !historyVisible;
    if (historyVisible) {
        historyDiv.classList.remove('hide');
        btn.textContent = "Hide History";
    } else {
        historyDiv.classList.add('hide');
        btn.textContent = "Show History";
    }
}
const music = document.getElementById('bgMusic');
function toggleMusic() {
    if (music.paused) {
        music.play();
    } else {
        music.pause();
    }
}
updatePercentagesDisplay();
updatePullCounter(false);

function updateBottomCountdown() {
    const targetDate = new Date("2026-08-26T00:00:00Z");
    const now = new Date();
    // Calculate full days remaining
    const todayUTC = new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate()));
    const msPerDay = 24 * 60 * 60 * 1000;
    let days = Math.ceil((targetDate - todayUTC) / msPerDay);
    if (days < 0) days = 0;
    document.getElementById('countdownDaysValue').textContent = days;
}
updateBottomCountdown();
setInterval(updateBottomCountdown, 60 * 60 * 1000);
</script>
</body>
</html>